<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>cds: cds::sync::spin_lock&lt; Backoff &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">cds
   &#160;<span id="projectnumber">2.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classcds_1_1sync_1_1spin__lock.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">cds::sync::spin_lock&lt; Backoff &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Spin lock.  
 <a href="classcds_1_1sync_1_1spin__lock.html#details">More...</a></p>

<p><code>#include &lt;cds/sync/spinlock.h&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a1d26e427c55ac064fed17193798010cc"><td class="memItemLeft" align="right" valign="top"><a id="a1d26e427c55ac064fed17193798010cc"></a>
typedef Backoff&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1sync_1_1spin__lock.html#a1d26e427c55ac064fed17193798010cc">backoff_strategy</a></td></tr>
<tr class="memdesc:a1d26e427c55ac064fed17193798010cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">back-off strategy type <br /></td></tr>
<tr class="separator:a1d26e427c55ac064fed17193798010cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa9b562d91956127919313188164db65c"><td class="memItemLeft" align="right" valign="top"><a id="aa9b562d91956127919313188164db65c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1sync_1_1spin__lock.html#aa9b562d91956127919313188164db65c">spin_lock</a> () noexcept()</td></tr>
<tr class="memdesc:aa9b562d91956127919313188164db65c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct free (unlocked) spin-lock. <br /></td></tr>
<tr class="separator:aa9b562d91956127919313188164db65c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abceeafd493ae3e5cc15d6f3b01df085f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1sync_1_1spin__lock.html#abceeafd493ae3e5cc15d6f3b01df085f">spin_lock</a> (bool bLocked) noexcept()</td></tr>
<tr class="memdesc:abceeafd493ae3e5cc15d6f3b01df085f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct spin-lock in specified state.  <a href="#abceeafd493ae3e5cc15d6f3b01df085f">More...</a><br /></td></tr>
<tr class="separator:abceeafd493ae3e5cc15d6f3b01df085f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b105d49850649cb3d9fcfb6b031802e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1sync_1_1spin__lock.html#a9b105d49850649cb3d9fcfb6b031802e">spin_lock</a> (const <a class="el" href="classcds_1_1sync_1_1spin__lock.html">spin_lock</a>&lt; Backoff &gt; &amp;) noexcept()</td></tr>
<tr class="memdesc:a9b105d49850649cb3d9fcfb6b031802e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dummy copy constructor.  <a href="#a9b105d49850649cb3d9fcfb6b031802e">More...</a><br /></td></tr>
<tr class="separator:a9b105d49850649cb3d9fcfb6b031802e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ef18bafb43996affd645d2ef1bee395"><td class="memItemLeft" align="right" valign="top"><a id="a0ef18bafb43996affd645d2ef1bee395"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1sync_1_1spin__lock.html#a0ef18bafb43996affd645d2ef1bee395">~spin_lock</a> ()</td></tr>
<tr class="memdesc:a0ef18bafb43996affd645d2ef1bee395"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. On debug time it checks whether spin-lock is free. <br /></td></tr>
<tr class="separator:a0ef18bafb43996affd645d2ef1bee395"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63fe4d0a24462aa60d798b1b7531efc6"><td class="memItemLeft" align="right" valign="top"><a id="a63fe4d0a24462aa60d798b1b7531efc6"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1sync_1_1spin__lock.html#a63fe4d0a24462aa60d798b1b7531efc6">is_locked</a> () const noexcept()</td></tr>
<tr class="memdesc:a63fe4d0a24462aa60d798b1b7531efc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the spin is locked. <br /></td></tr>
<tr class="separator:a63fe4d0a24462aa60d798b1b7531efc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fcc0dc9f3ad0fa9b9db81f16642e96c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1sync_1_1spin__lock.html#a3fcc0dc9f3ad0fa9b9db81f16642e96c">try_lock</a> () noexcept()</td></tr>
<tr class="memdesc:a3fcc0dc9f3ad0fa9b9db81f16642e96c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to lock the object.  <a href="#a3fcc0dc9f3ad0fa9b9db81f16642e96c">More...</a><br /></td></tr>
<tr class="separator:a3fcc0dc9f3ad0fa9b9db81f16642e96c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1652f5a6b0bfa13252e4e7940160bc9e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1sync_1_1spin__lock.html#a1652f5a6b0bfa13252e4e7940160bc9e">try_lock</a> (unsigned int nTryCount) CDS_NOEXCEPT_(noexcept(<a class="el" href="classcds_1_1sync_1_1spin__lock.html#a1d26e427c55ac064fed17193798010cc">backoff_strategy</a>()()))</td></tr>
<tr class="memdesc:a1652f5a6b0bfa13252e4e7940160bc9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to lock the object, repeat <code>nTryCount</code> times if failed.  <a href="#a1652f5a6b0bfa13252e4e7940160bc9e">More...</a><br /></td></tr>
<tr class="separator:a1652f5a6b0bfa13252e4e7940160bc9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82fbff1716987bef7cc086291512c22d"><td class="memItemLeft" align="right" valign="top"><a id="a82fbff1716987bef7cc086291512c22d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1sync_1_1spin__lock.html#a82fbff1716987bef7cc086291512c22d">lock</a> () CDS_NOEXCEPT_(noexcept(<a class="el" href="classcds_1_1sync_1_1spin__lock.html#a1d26e427c55ac064fed17193798010cc">backoff_strategy</a>()()))</td></tr>
<tr class="memdesc:a82fbff1716987bef7cc086291512c22d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lock the spin-lock. Waits infinitely while spin-lock is locked. Debug version: deadlock may be detected. <br /></td></tr>
<tr class="separator:a82fbff1716987bef7cc086291512c22d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab222d042e6d386e4aac166cbd206fcdc"><td class="memItemLeft" align="right" valign="top"><a id="ab222d042e6d386e4aac166cbd206fcdc"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1sync_1_1spin__lock.html#ab222d042e6d386e4aac166cbd206fcdc">unlock</a> () noexcept()</td></tr>
<tr class="memdesc:ab222d042e6d386e4aac166cbd206fcdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unlock the spin-lock. Debug version: deadlock may be detected. <br /></td></tr>
<tr class="separator:ab222d042e6d386e4aac166cbd206fcdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a134ba6d996d3828c614263d43266ca7d"><td class="memItemLeft" align="right" valign="top"><a id="a134ba6d996d3828c614263d43266ca7d"></a>
atomics::atomic&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcds_1_1sync_1_1spin__lock.html#a134ba6d996d3828c614263d43266ca7d">m_spin</a></td></tr>
<tr class="memdesc:a134ba6d996d3828c614263d43266ca7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Spin. <br /></td></tr>
<tr class="separator:a134ba6d996d3828c614263d43266ca7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename Backoff&gt;<br />
class cds::sync::spin_lock&lt; Backoff &gt;</h3>

<p>Spin lock. </p>
<p>Simple and light-weight spin-lock critical section It is useful to gain access to small (short-timed) code</p>
<p>Algorithm:</p>
<p>TATAS (test-and-test-and-lock) [1984] L. Rudolph, Z. Segall. Dynamic Decentralized Cache Schemes for MIMD Parallel Processors.</p>
<p>No serialization performed - any of waiting threads may owns the spin-lock. This spin-lock is NOT recursive: the thread owned the lock cannot call <code><a class="el" href="classcds_1_1sync_1_1spin__lock.html#a82fbff1716987bef7cc086291512c22d" title="Lock the spin-lock. Waits infinitely while spin-lock is locked. Debug version: deadlock may be detect...">lock()</a></code> method without deadlock. The method <code><a class="el" href="classcds_1_1sync_1_1spin__lock.html#ab222d042e6d386e4aac166cbd206fcdc" title="Unlock the spin-lock. Debug version: deadlock may be detected. ">unlock()</a></code> can call any thread</p>
<p>DEBUG version: The spinlock stores owner thead id. Assertion is raised when:</p><ul>
<li>double lock attempt encountered by same thread (deadlock)</li>
<li>unlock by another thread</li>
</ul>
<p>If spin-lock is locked the <code>Backoff</code> algorithm is called. Predefined <code><a class="el" href="namespacecds_1_1backoff.html#a42efe4d5690bfb85c702b6aadccc3d68" title="Default back-off strategy for lock primitives. ">backoff::LockDefault</a></code> class yields current thread and repeats lock attempts later</p>
<p>Template parameters:</p><ul>
<li><code>Backoff</code> - backoff strategy. Used when spin lock is locked </li>
</ul>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="abceeafd493ae3e5cc15d6f3b01df085f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abceeafd493ae3e5cc15d6f3b01df085f">&sect;&nbsp;</a></span>spin_lock() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Backoff &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcds_1_1sync_1_1spin__lock.html">cds::sync::spin_lock</a>&lt; Backoff &gt;::<a class="el" href="classcds_1_1sync_1_1spin__lock.html">spin_lock</a> </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bLocked</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct spin-lock in specified state. </p>
<p>In debug mode: if <code>bLocked</code> = true then spin-lock is made owned by current thread </p>

</div>
</div>
<a id="a9b105d49850649cb3d9fcfb6b031802e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b105d49850649cb3d9fcfb6b031802e">&sect;&nbsp;</a></span>spin_lock() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Backoff &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcds_1_1sync_1_1spin__lock.html">cds::sync::spin_lock</a>&lt; Backoff &gt;::<a class="el" href="classcds_1_1sync_1_1spin__lock.html">spin_lock</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcds_1_1sync_1_1spin__lock.html">spin_lock</a>&lt; Backoff &gt; &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dummy copy constructor. </p>
<p>In theory, spin-lock cannot be copied. However, it is not practical. Therefore, we provide dummy copy constructor that do no copy in fact. The ctor initializes the spin to free (unlocked) state like default ctor. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a3fcc0dc9f3ad0fa9b9db81f16642e96c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fcc0dc9f3ad0fa9b9db81f16642e96c">&sect;&nbsp;</a></span>try_lock() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Backoff &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classcds_1_1sync_1_1spin__lock.html">cds::sync::spin_lock</a>&lt; Backoff &gt;::try_lock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Try to lock the object. </p>
<p>Returns <code>true</code> if locking is succeeded otherwise (if the spin is already locked) returns <code>false</code> </p>
<p>Debug version: deadlock can be detected </p>

</div>
</div>
<a id="a1652f5a6b0bfa13252e4e7940160bc9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1652f5a6b0bfa13252e4e7940160bc9e">&sect;&nbsp;</a></span>try_lock() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Backoff &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classcds_1_1sync_1_1spin__lock.html">cds::sync::spin_lock</a>&lt; Backoff &gt;::try_lock </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>nTryCount</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Try to lock the object, repeat <code>nTryCount</code> times if failed. </p>
<p>Returns <code>true</code> if locking is succeeded otherwise (if the spin is already locked) returns <code>false</code> </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>cds/sync/spinlock.h</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<hr/>
<div align="right">
  <b>cds</b> <b>2.2.0</b> 
  Developed by <i>Maxim Khizhinsky aka khizmax</i> 2007 - 2017
  <br/>
  <i>Autogenerated Wed Jan 4 2017 08:50:07 by Doxygen 1.8.12</i>
</div>
</body>
</html>
